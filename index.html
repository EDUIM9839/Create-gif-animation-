<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WhatsApp Style Text to GIF</title>
  <script src="https://cdn.jsdelivr.net/npm/gifshot@0.3.2/build/gifshot.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 20px;
      background-color: #e5ddd5;
    }
    textarea {
      width: 90%;
      height: 100px;
      font-size: 16px;
      margin-bottom: 10px;
    }
    .chat-bubble {
      max-width: 70%;
      padding: 10px 14px;
      border-radius: 8px;
      margin: 5px;
      font-size: 18px;
      display: inline-block;
    }
    .left {
      background-color: white;
      color: black;
      align-self: flex-start;
    }
    .right {
      background-color: #dcf8c6;
      color: black;
      align-self: flex-end;
    }
    #result {
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <h2>üí¨ WhatsApp Chat to GIF</h2>

  <textarea id="chatInput">üëã Hello!\nHow are you?\nI'm good üòä\nWhat's up?</textarea><br>

  Style:
  <select id="styleSelect">
    <option value="left">Left (Friend)</option>
    <option value="right">Right (You)</option>
  </select>

  <button onclick="generateGif()">Generate WhatsApp GIF</button>

  <div id="result">GIF will appear here</div>

  <script>
    function generateGif() {
      const lines = document.getElementById("chatInput").value.trim().split("\n");
      const style = document.getElementById("styleSelect").value;

      const frames = lines.map((line, i) => {
        let bubbles = '';
        for (let j = 0; j <= i; j++) {
          const side = j % 2 === 0 ? style : (style === 'left' ? 'right' : 'left');
          bubbles += `<div class="chat-bubble ${side}">${lines[j]}</div><br>`;
        }

        return `
          <div style="width:300px;height:200px;padding:10px;background:#e5ddd5;display:flex;flex-direction:column;">
            ${bubbles}
          </div>
        `;
      });

      document.getElementById("result").innerText = "Generating...";

      gifshot.createGIF({
        gifWidth: 300,
        gifHeight: 200,
        interval: 1.2,
        frameHtml: frames,
        numFrames: frames.length,
        html2Canvas: true
      }, function(obj) {
        const result = document.getElementById("result");
        if (!obj.error) {
          const img = document.createElement('img');
          img.src = obj.image;

          const link = document.createElement('a');
          link.href = obj.image;
          link.download = 'whatsapp_chat.gif';
          link.textContent = '‚¨áÔ∏è Download GIF';

          result.innerHTML = '';
          result.appendChild(img);
          result.appendChild(document.createElement('br'));
          result.appendChild(link);
        } else {
          result.innerText = "‚ùå Failed to generate GIF.";
        }
      });
    }
  </script>

</body>
</html>
